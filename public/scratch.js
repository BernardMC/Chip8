console.log("Hello from scratch 3")

const brekoutLocation = "https://github.com/loktar00/chip8/blob/master/roms/Breakout%20%5BCarmelo%20Cortez,%201979%5D.ch8?raw=true";

async function getGitRom() {
   const response = await fetch(
   "https://github.com/loktar00/chip8/blob/master/roms/Breakout%20%5BCarmelo%20Cortez,%201979%5D.ch8?raw=true",{mode: 'no-cors'}
   );
   const blob = await response.blob();
   console.log(new Response(blob).arrayBuffer())
   return await new Response(blob).arrayBuffer();
 }

 const GameTitles = {
    "Chip8Logo":"https://cdn.glitch.com/1749964c-1292-4b7b-9396-0fb906858f51%2FChip8%20emulator%20Logo%20%5BGarstyciuks%5D.ch8?v=1590012730017",
    "TICTAC":"https://cdn.glitch.com/24f600cc-3c55-4c5c-a34b-629142d92065%2FTICTAC?v=1591646552646",
    "PUZZLE":"https://cdn.glitch.com/24f600cc-3c55-4c5c-a34b-629142d92065%2FPUZZLE?v=1591646564682",
    "UFO":"https://cdn.glitch.com/24f600cc-3c55-4c5c-a34b-629142d92065%2FUFO?v=1591646570711",
    "SYZYGY":"https://cdn.glitch.com/24f600cc-3c55-4c5c-a34b-629142d92065%2FSYZYGY?v=1591646582140",
    "TANK":"https://cdn.glitch.com/24f600cc-3c55-4c5c-a34b-629142d92065%2FTANK?v=1591646557817"
 }

const breakOutRom = new Uint8Array(
   [
   0xa2,0xcc, 0x6a,0x06, 0x61,0x03, 0x6b,0x08, 0x60,0x00, 0xd0,0x11, 0x70,0x08, 0x7b,0xff,
   0x3b,0x00, 0x12,0x0a, 0x71,0x02, 0x7a,0xff, 0x3a,0x00, 0x12,0x06, 0x66,0x00, 0x67,0x14,
   0xa2,0xcd, 0x60,0x20, 0x61,0x1e, 0xd0,0x11, 0x63,0x1d, 0x62,0x3f, 0x82,0x02, 0x77,0xff,
   0x47,0x00, 0x12,0xaa, 0xff,0x0a, 0xa2,0xcb, 0xd2,0x31, 0x65,0xff, 0xc4,0x01, 0x34,0x01,
   0x64,0xff, 0xa2,0xcd, 0x6c,0x00, 0x6e,0x04, 0xee,0xa1, 0x6c,0xfe, 0x6e,0x06, 0xee,0xa1,
   0x6c,0x02, 0xd0,0x11, 0x80,0xc4, 0xd0,0x11, 0x4f,0x01, 0x12,0x98, 0x42,0x00, 0x64,0x01,
   0x42,0x3f, 0x64,0xff, 0x43,0x00, 0x12,0xce, 0x43,0x1f, 0x12,0xa4, 0xa2,0xcb, 0xd2,0x31,
   0x82,0x44, 0x83,0x54, 0xd2,0x31, 0x3f,0x01, 0x12,0x42, 0x43,0x1e, 0x12,0x98, 0x6a,0x02,
   0xfa,0x18, 0x76,0x01, 0xa2,0xca, 0x12,0x88, 0xd2,0x31, 0xc4,0x01, 0x34,0x01, 0x64,0xff,
   0xc5,0x01, 0x35,0x01, 0x65,0x01, 0x12,0x42, 0x6a,0x03, 0xfa,0x18, 0xa2,0xcb, 0xd2,0x31,
   0x73,0xff, 0x12,0x36, 0xa2,0xcb, 0xd2,0x31, 0x12,0x28, 0xa2,0xcd, 0xd0,0x11, 0xa2,0xf0,
   0xf6,0x33, 0xf2,0x65, 0x63,0x18, 0x64,0x1b, 0xf0,0x29, 0xd3,0x45, 0x73,0x05, 0xf1,0x29,
   0xd3,0x45, 0x73,0x05, 0xf2,0x29, 0xd3,0x45, 0x12,0xc8, 0xf0,0x80, 0xff,0xff, 0xa2,0xde,
   0x63,0x15, 0x62,0x10, 0xd3,0x25, 0xa2,0xe3, 0x63,0x1d, 0xd3,0x25, 0x12,0xaa, 0xee,0x8a,
   0xce,0x8c, 0x8a,0xee, 0x88,0xcc, 0x88,0xee
   ]);

function LoadRom(){
   dowork(breakOutRom);
}

const DoIt = () => {
    var img1 = document.getElementById('myImg1');
      var img2 = document.getElementById('myImg2');
      var myCanvas = document.getElementById("canvas");
      var ctx = canvas.getContext("2d");

      // width and height
      var w = img1.width;
      var h = img1.height;

      myCanvas.width = w;
      myCanvas.height = h;

      var pixels = 4 * w * h;
      ctx.drawImage(myImg1, 0, 0, w, h, 0, 0, 900, 900);

      var image1 = ctx.getImageData(0, 0, w, h);
      var imageData1 = image1.data;
      ctx.drawImage(myImg2, 0, 0)
      var image2 = ctx.getImageData(0, 0, w, h);
      var imageData2 = image2.data
      while (pixels--) {
         imageData1[pixels] = imageData1[pixels] * 0.5 + imageData2[pixels] * 0.5;
      }
      image1.data = imageData1;
      ctx.putImageData(image1, 0, 0);
}